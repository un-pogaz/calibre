#!/usr/bin/env python
# vim:fileencoding=utf-8

__license__ = 'GPL v3'
__copyright__ = '2010-2013, Darko Miletic <darko.miletic at gmail.com>'
'''
www.kommersant.ru
'''

from calibre.web.feeds.news import BasicNewsRecipe, classes


class Kommersant_ru(BasicNewsRecipe):
    title = 'Kommersant'
    __author__ = 'Darko Miletic (with fixes by bugmen00t)'
    description = 'News from Russia'
    publisher = 'Kommersant'
    category = 'news, politics, Russia'
    oldest_article = 7
    max_articles_per_feed = 50
    no_stylesheets = True
    use_embedded_content = False
    language = 'ru'
    publication_type = 'newspaper'
    cover_url = 'https://iv.kommersant.ru/ContentFlex/images/logo.png'

    remove_tags_before = dict(name='header', attrs={'class': 'doc_header'})

    remove_tags_after = dict(
        name='div', attrs={'class': 'doc__text document_authors'}
    )

    remove_tags = [
        dict(name='ul', attrs={'class': 'crumbs'}),
        dict(name='div', attrs={'class': 'hide_desktop'}),
        dict(name='div', attrs={'class': 'incut incut--right'}),
        dict(name='div', attrs={'class': 'incut incut--left'}),
        dict(name='div', attrs={'class': 'incut incut--center'}),
        dict(name='div', attrs={'class': 'ba'}),
        dict(name='div', attrs={'id': 'lenta'}),
        dict(name='div', attrs={'class': 'layout basement_news__body'}),
        dict(name='footer', attrs={'class': 'footer'}),
        dict(name='section', attrs={'class': 'potd'}),
        dict(name='footer', attrs={'class': 'doc_footer'}),
        classes('ui-modal__hide'),
        dict(name='div', attrs={'class': 'adv_interscroll hide_desktop'}),
        dict(name=['button', 'source']),
    ]

    def preprocess_html(self, soup):
        for tag in soup.findAll(attrs={'data-lazyimage-src': True}):
            tag['src'] = tag['data-lazyimage-src']
        return soup

    feeds = [
        (
            'Главное',
            'https://www.kommersant.ru/rss/main.xml'
        ),
        (
            'Газета "Коммерсант"',
            'https://www.kommersant.ru/rss/daily.xml'
        ),
        (
            'Лента новостей',
            'https://www.kommersant.ru/RSS/news.xml'
        ),
        (
            'Материалы с сайта',
            'https://www.kommersant.ru/RSS/corp.xml'
        ),
        (
            'Радио Коммерсантъ-FM',
            'https://www.kommersant.ru/RSS/radio.xml'
        ),
        (
            'Тематические приложения',
            'https://www.kommersant.ru/RSS/tema.xml'
        ),
        (
            'Журнал «ОГОНЁК»',
            'https://www.kommersant.ru/RSS/ogoniok.xml'
        ),
        (
            'Журнал «Коммерсантъ WEEKEND»',
            'https://www.kommersant.ru/RSS/weekend.xml'
        ),
        (
            'Журнал «Коммерсантъ АВТОПИЛОТ»',
            'https://www.kommersant.ru/RSS/auto.xml'
        ),
        (
            'Политика',
            'https://www.kommersant.ru/rss/section-politics.xml'
        ),
        (
            'Экономика',
            'https://www.kommersant.ru/RSS/section-economics.xml'
        ),
        (
            'Бизнес',
            'https://www.kommersant.ru/rss/section-business.xml'
        ),
        (
            'В мире',
            'https://www.kommersant.ru/rss/section-world.xml'
        ),
        (
            'Происшествия',
            'https://www.kommersant.ru/rss/section-accidents.xml'
        ),
        (
            'Общество',
            'https://www.kommersant.ru/rss/section-society.xml'
        ),
        (
            'Культура',
            'https://www.kommersant.ru/rss/section-culture.xml'
        ),
        (
            'Спорт',
            'https://www.kommersant.ru/rss/section-sport.xml'
        ), ('Hi-Tech', 'https://www.kommersant.ru/RSS/section-hitech.xml'),
        (
            'Авто',
            'https://www.kommersant.ru/RSS/Autopilot_on.xml'
        ),
        (
            'Стиль',
            'https://www.kommersant.ru/RSS/section-style.xml'
        ),
        (
            'Санкт-Петербург',
            'https://www.kommersant.ru/rss/regions/piter_all.xml'
        ),
        (
            'Воронеж',
            'https://www.kommersant.ru/rss/regions/vrn_all.xml'
        ),
        (
            'Екатеринбург',
            'https://www.kommersant.ru/rss/regions/ekaterinburg_all.xml'
        ),
        (
            'Ижевск',
            'https://www.kommersant.ru/rss/regions/izhevsk_all.xml'
        ),
        (
            'Казань',
            'https://www.kommersant.ru/rss/regions/kazan_all.xml'
        ),
        (
            'Краснодар',
            'https://www.kommersant.ru/rss/regions/krasnodar_all.xml'
        ),
        (
            'Красноярск',
            'https://www.kommersant.ru/rss/regions/krasnoyarsk_all.xml'
        ),
        (
            'Нижний Новгород',
            'https://www.kommersant.ru/rss/regions/nnov_all.xml'
        ),
        (
            'Новосибирск',
            'https://www.kommersant.ru/rss/regions/novosibirsk_all.xml'
        ),
        (
            'Пермь',
            'https://www.kommersant.ru/rss/regions/perm_all.xml'
        ),
        (
            'Ростов-на-Дону',
            'https://www.kommersant.ru/rss/regions/rostov_all.xml'
        ),
        (
            'Самара',
            'https://www.kommersant.ru/rss/regions/samara_all.xml'
        ),
        (
            'Саратов',
            'https://www.kommersant.ru/rss/regions/saratov_all.xml'
        ),
        ('Уфа', 'https://www.kommersant.ru/rss/regions/ufa_all.xml'),
        (
            'Челябинск',
            'https://www.kommersant.ru/rss/regions/chelyabinsk_all.xml'
        )
    ]
