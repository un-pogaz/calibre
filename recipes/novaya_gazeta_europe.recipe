#!/usr/bin/env python

from calibre.web.feeds.news import BasicNewsRecipe


class NovayaGazetaEurope(BasicNewsRecipe):
    title = 'Новая Газета. Европа'
    __author__ = 'bugmen00t'
    description = 'Говорим как есть. Пишем о происходящем в России, Украине и Европе. Новости, аналитика, мнения экспертов, специальные репортажи и журналистские расследования.'  # noqa
    publisher = 'Кирилл Мартынов'
    publication_type = 'newspaper'
    category = 'news'
    language = 'ru'
    cover_url = 'https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com/public/images/5dc71e2d-9763-4f05-8f4e-92049fa32af7_513x513.png'
    oldest_article = 15
    max_articles_per_feed = 50
    auto_cleanup = False

    remove_tags_before = dict(name='h1')

    remove_tags_after = dict(
        name='div', attrs={'class': 'ArticleBlocks_wrapperNoAside__11_bu'}
    )

    remove_tags = [dict(name='div', attrs={'class': 'EmbedNative_root__2lgsH'})]

    feeds = [(
        'Новости',
        'https://novayagazeta.eu/feed/rss/ru'
    )]

    def preprocess_html(self, soup):
        for alink in soup.findAll('a'):
            if alink.string is not None:
                tstr = alink.string
                alink.replaceWith(tstr)
        return soup
